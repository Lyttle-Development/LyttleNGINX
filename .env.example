# LyttleNGINX Environment Configuration
# Copy this file to .env and configure for your environment

# =====================
# Database Configuration
# =====================
DATABASE_URL=postgresql://user:password@localhost:5432/lyttlenginx

# =====================
# Application Configuration
# =====================
PORT=3000
NODE_ENV=production  # production | development

# =====================
# TLS/SSL Configuration
# =====================

# Email for Let's Encrypt certificate registration (REQUIRED for production)
ADMIN_EMAIL=admin@example.com

# Days before certificate expiry to trigger renewal
# Default: 30 days
RENEW_BEFORE_DAYS=30

# =====================
# Optional TLS Settings
# =====================

# Custom DNS resolvers for OCSP stapling (comma-separated)
# Default: 8.8.8.8,8.8.4.4,1.1.1.1
# DNS_RESOLVERS=8.8.8.8,8.8.4.4,1.1.1.1

# Enable DH parameter generation on startup (slow, ~5 minutes)
# Default: false
# GENERATE_DHPARAM=false

# DH parameter key size (2048 or 4096)
# Default: 2048
# DHPARAM_BITS=2048

# =====================
# NGINX Configuration
# =====================

# Path to NGINX configuration directory
# Default: /etc/nginx
# NGINX_CONF_DIR=/etc/nginx

# Path to Let's Encrypt certificates
# Default: /etc/letsencrypt
# LETSENCRYPT_DIR=/etc/letsencrypt

# =====================
# Logging
# =====================

# Log level: error | warn | log | debug | verbose
# Default: log
# LOG_LEVEL=log

# =====================
# Security (Recommended for Production)
# =====================

# API Key for certificate management endpoints (ready for implementation)
# JWT and Passport packages are installed, implement as needed
# API_KEY=your-secret-api-key

# JWT Secret for authentication (ready for implementation)
# JWT and Passport packages are installed, implement as needed
# Minimum 32 characters recommended
# JWT_SECRET=your-jwt-secret-minimum-32-characters-long

# Rate limiting override (requests per time window)
# ✅ Rate limiting is FULLY IMPLEMENTED (3-tier system)
# SHORT: requests per second (default: 10)
# MEDIUM: requests per minute (default: 60)
# LONG: requests per 15 minutes (default: 100)
# RATE_LIMIT_SHORT=10
# RATE_LIMIT_MEDIUM=60
# RATE_LIMIT_LONG=100

# =====================
# Monitoring & Alerts (✅ FULLY IMPLEMENTED)
# =====================

# Email notifications for expiring certificates
# Alerts are sent for: expiring soon, expired, renewal success/failure
ALERT_EMAIL=alerts@example.com
ALERT_FROM_EMAIL=noreply@example.com

# SMTP Configuration for email alerts
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# Alert threshold (days before expiry to send alert)
# Default: 14 days
ALERT_THRESHOLD_DAYS=14

# Slack webhook for alerts
# Integrated with AlertService - ready to use
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Discord webhook for alerts
# Integrated with AlertService - ready to use
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/WEBHOOK

# =====================
# Backup Configuration (✅ FULLY IMPLEMENTED)
# =====================

# Directory for certificate backups
# Default: /tmp/cert-backups
# API endpoints: POST /certificates/backup, GET /certificates/backup, etc.
BACKUP_DIR=/var/backups/certificates

# Backup retention (days) - for automated cleanup scripts
# Default: 30 days
BACKUP_RETENTION_DAYS=30

# =====================
# Advanced Configuration (✅ IMPLEMENTED)
# =====================

# Certificate cleanup interval (hours)
# How often to check for orphaned certificates
# Default: 24 hours
CERT_CLEANUP_INTERVAL=24

# Certificate renewal check interval (milliseconds)
# How often to check for certificates needing renewal
# Default: 43200000 (12 hours)
CERT_RENEWAL_INTERVAL=43200000

# Certificate monitoring cron schedule
# Daily health check and alert schedule (cron expression format)
# Default: "0 9 * * *" (9 AM daily)
CERT_MONITOR_CRON=0 9 * * *

# Nginx reload interval (minutes)
# How often to check for proxy entry changes and reload
# Default: 5 minutes
NGINX_RELOAD_INTERVAL=5

# Prometheus metrics cache duration (seconds)
# How long to cache metrics before recalculating
# Default: 30 seconds
METRICS_CACHE_DURATION=30

# =====================
# Development Settings
# =====================

# Skip Let's Encrypt in development
# Set NODE_ENV=development to use self-signed certificates
# When NODE_ENV=development, certbot commands are skipped

# Development domain for testing
DEV_DOMAIN=localhost

# Skip DNS validation in development
# Useful when working with local domains
SKIP_DNS_VALIDATION=true

# Enable debug logging
# Set LOG_LEVEL=debug for verbose output
DEBUG=false

# Disable rate limiting in development
# DISABLE_RATE_LIMITING=true

# =====================
# Production Checklist
# =====================

# 1. Set NODE_ENV=production and configure DATABASE_URL
# 2. Set ADMIN_EMAIL for Let's Encrypt notifications
# 3. Configure JWT_SECRET and ADMIN_PASSWORD for API security
# 4. Set up SMTP for email alerts
# 5. Configure Slack/Discord webhooks for instant notifications
# 6. Set secure BACKUP_DIR with proper permissions
# 7. Review rate limiting settings if needed
# 8. Configure Prometheus scraping from /metrics
# 9. Set up automated backup scripts (cron)
# 10. Monitor /metrics/json for certificate health

# =====================
# Quick Start (Minimal Config)
# =====================

# For a quick start, only these are required:
# DATABASE_URL=postgresql://user:password@host:5432/db
# ADMIN_EMAIL=admin@example.com
# NODE_ENV=production

