server {
    listen 80 default_server;
    server_name _;

    # Serve static files first, then fall back to SPA index.html, otherwise 500
    root /etc/nginx/html;

    location / {
        try_files $uri $uri/ /index.html =500;
    }

    # Let SPA handle client-side routes (convert common 4xx to index.html with 200)
    error_page 400 401 402 403 404 405 408 409 410 411 412 413 414 415 416 417 418 421 422 423 424 425 426 428 429 431 444 451 494 495 496 497 =200 /index.html;

    # Ensure 5xx render the custom error page (and are not swallowed by SPA)
    error_page 500 501 502 503 504 505 506 507 508 510 511 /errors/50x.html;

    # Allow direct access to the error asset
    location ^~ /errors/ {
        # No special handling; served from /etc/nginx/html/errors/...
        expires 1m;
        add_header Cache-Control "public, max-age=60";
    }

    # Prevent direct navigation to the SPA fallback target
    location = /index.html {
        internal;
    }
}